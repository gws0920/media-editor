var qe=Object.defineProperty,We=Object.defineProperties;var je=Object.getOwnPropertyDescriptors;var Oe=Object.getOwnPropertySymbols;var Ze=Object.prototype.hasOwnProperty,Je=Object.prototype.propertyIsEnumerable;var Pe=(t,e,n)=>e in t?qe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,fe=(t,e)=>{for(var n in e||(e={}))Ze.call(e,n)&&Pe(t,n,e[n]);if(Oe)for(var n of Oe(e))Je.call(e,n)&&Pe(t,n,e[n]);return t},me=(t,e)=>We(t,je(e));var w=(t,e,n)=>(Pe(t,typeof e!="symbol"?e+"":e,n),n);import{d as Te,M as we,a as O,r as N,u as Ee,o as m,c as T,w as _,b as a,e as C,f as de,F as re,g as i,N as Qe,h as et,i as tt,j as nt,k as B,l as he,m as st,n as U,t as ae,p as G,q as K,S as ot,P as it,s as rt,v as at,x as pe,y as Me,z as lt,A as $e,B as Le,U as ct,R as ut,C as J,D as dt,E as pt,G as _t,H as ft,I as mt,J as ht,K as vt,L as Re,_ as gt,O as Ae,Q as yt,T as kt,V as Ne,W as Ct,X as Ve,Y as xt,Z as It,$ as Fe,a0 as te,a1 as ne,a2 as ve,a3 as Pt,a4 as Tt,a5 as wt,a6 as Et,a7 as St,a8 as bt,a9 as Dt,aa as Ot,ab as ge,ac as Mt,ad as $t,ae as Lt,af as Rt,ag as At,ah as Nt}from"./vendor.a70173a8.js";const Vt=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))s(l);new MutationObserver(l=>{for(const o of l)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function n(l){const o={};return l.integrity&&(o.integrity=l.integrity),l.referrerpolicy&&(o.referrerPolicy=l.referrerpolicy),l.crossorigin==="use-credentials"?o.credentials="include":l.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(l){if(l.ep)return;l.ep=!0;const o=n(l);fetch(l.href,o)}};Vt();const Xe=25,le=[{STEP:16,TIME:6e6,GROUP:10},{STEP:18,TIME:3e6,GROUP:10},{STEP:16,TIME:2e6,GROUP:10},{STEP:14,TIME:1e6,GROUP:10},{STEP:12,TIME:1e6/10,GROUP:10},{STEP:15,TIME:1e6/Xe,GROUP:10}],H=60,q=40,se=140,Ft=2,Ye=["79a4f2","79f2da","f29f79","f2d879","79f2b4"],Q=Te("interactive",{state:()=>({isDragging:!1,translate:[0,0],sings:[],moveOffset:0,moveOffsetY:0,lineY:{show:!1,pos:0},lineX:{show:!1,pos:0},level:3}),actions:{setDragging(t){this.isDragging=!!t,t||(this.lineY={show:!1,pos:0},this.lineX={show:!1,pos:0})},setTranslate(t,e){this.translate=[t||0,e||0]},setLevel(t){this.level=t}}});function Se(t){const e=~~(t%1e6/1e6*Xe),n=Math.floor(t/1e6),s=Math.floor(n/60),l=Math.floor(s/60);return`${ye(l)}:${ye(s%60)}:${ye(n%60)}:${ye(e)}`}function ye(t,e=2){return(Array(e).join("0")+t).slice(-e)}function V(t){const e=Q(),{STEP:n,TIME:s}=le[e.level];return n/s*t}function oe(t){const e=Q(),{STEP:n,TIME:s}=le[e.level];return~~(s/n*t)}const ze=t=>{const{trimIn:e,trimOut:n,speed:s,duration:l,thumbnail:o,inPoint:c,outPoint:r}=t,u=V(r-c),p=(H-4)/9*16;let f=0;const h=[];let x=0;for(;f<u;){const v=o.replace("#color#",Ye[x%Ye.length])+(~~(oe(f)/1e6)||"00");h.push(`url(${v}) ${f}px 0 /${p}px 101% no-repeat`),f+=p,x++}return h};var E;(function(t){t.VIDEO="VIDEO_TRACK",t.AUDIO="AUDIO_TRACK",t.CAPTION="CAPTION_TRACK",t.STICKER="STICKER_TRACK"})(E||(E={}));var M;(function(t){t.VIDEO="VIDEO",t.AUDIO="AUDIO",t.CAPTION="CAPTION",t.STICKER="STICKER"})(M||(M={}));var be;(function(t){t.AUDIO="rgb(38, 113, 128)",t.CAPTION="#9c76f5",t.FX="#6b6fe5",t.STICKER="#6b6fe5"})(be||(be={}));function _e(){function t(){return((1+Math.random())*65536|0).toString(16).substring(1)}return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()}function ke(t,[e,n]){return Math.min(n,Math.max(e,t))}class Ce{constructor(e){w(this,"id");w(this,"type");w(this,"show");w(this,"volume");w(this,"clips");this.id=e.id||_e(),this.type=e.type,this.clips=e.clips||[],this.volume=e.volume===void 0?1:e.volume,this.show=e.show===void 0?!0:e.show}}class xe{constructor(e){w(this,"inPoint");w(this,"outPoint");w(this,"duration");w(this,"name");w(this,"id");w(this,"thumbnail");w(this,"trimOut");w(this,"trimIn");w(this,"speed");w(this,"trackId");w(this,"type");this.inPoint=e.inPoint===void 0?0:e.inPoint,this.outPoint=e.outPoint===void 0?0:e.outPoint,this.name=e.name||"",this.id=e.id||_e(),this.duration=e.duration===void 0?0:e.duration,this.thumbnail=e.thumbnail||"",this.trimOut=e.trimOut===void 0?0:e.trimOut,this.trimIn=e.trimIn===void 0?0:e.trimIn,this.trackId=e.trackId||"",this.type=e.type}}function Xt(t,e){let n=0;if(Array.isArray(t)){let[c,r]=t;n=~~(Math.random()*(r-c))+c}else n=t;const s={[`data|${n}`]:[{"duration|1000000-20000000":2e7,thumbnail:"https://dummyimage.com/480x270/#color#/FFFFFF&text=",name:"@ctitle(3,15)"}]},l=we.mock(s);let o=0;return l.data.map(c=>{const r=new xe(me(fe({},c),{inPoint:o,trackId:e,outPoint:o+c.duration,type:M.VIDEO}));return o+=c.duration+~~(3e6*Math.random()),r})}function Be(t,e,n){let s=0;if(Array.isArray(t)){let[r,u]=t;s=~~(Math.random()*(u-r))+r}else s=t;const l={[`data|${s}`]:[{"duration|1000000-20000000":2e7,name:"@ctitle(3,8)"}]},o=we.mock(l);let c=0;return o.data.map(r=>{const u=new xe(me(fe({},r),{inPoint:c,trackId:e,outPoint:c+r.duration,type:n}));return c+=r.duration+~~(3e6*Math.random()),u})}function Yt(t,e){const n=[];for(let o=0;o<t;o++){const c=_e();n.push(new Ce({id:c,type:E.VIDEO,show:!0,volume:1,clips:Xt(e,c)}))}const s=_e();n.push(new Ce({id:s,type:E.STICKER,show:!0,clips:Be(e,s,M.STICKER)}));const l=_e();return n.push(new Ce({id:l,type:E.CAPTION,show:!0,clips:Be(e,l,M.CAPTION)})),n}function zt(t=3,e=[3,18]){return{tracks:Yt(t,e),speed:1}}const j=Te("timeline",{state:()=>({tlData:zt(3),curClips:new Set,curTracks:new Set,isDragging:!1,isPlaying:!1,seekVal:0,duration:0}),actions:{setDragging(t){this.isDragging=!!t},addCurClip(t){this.curClips.add(t)},removeCurClip(t){this.curClips.delete(t)},clearCurClip(){this.curClips.clear()},addCurTracks(t){this.curTracks.add(t)},removeCurTracks(t){this.curTracks.delete(t)},clearCurTracks(){this.curTracks.clear()},getSings(){const{tracks:t}=this.tlData,e=new Map;return t.forEach(n=>{n.clips.forEach(s=>{this.curClips.has(s)||(e.set(s.inPoint,V(s.inPoint)),e.set(s.outPoint,V(s.outPoint)))})}),[...e.entries()]},getMinMax(){let t=[1/0,-1/0];return this.curClips.forEach(e=>{const[n,s]=t;e.inPoint<n&&(t[0]=e.inPoint),e.outPoint>s&&(t[1]=e.outPoint)}),t},getCurClipType(){let t="";return this.curClips.forEach(e=>{t=e.type}),t},isSameTrack(){return[...this.curClips].every((t,e,n)=>t.trackId===n[0].trackId)},moveCurClips(t,e){this.curClips.forEach(o=>{o.outPoint+=Math.max(-o.inPoint,t),o.inPoint+=Math.max(-o.inPoint,t)});const n=this.getCurClipType()===M.VIDEO?H:q,s=e/n,l=this.getCurClipGroup();for(let[o,c]of l){const r=this.tlData.tracks.indexOf(o);let u;e%n==0?u=this.tlData.tracks[r+s]:(u=new Ce({type:o.type}),this.tlData.tracks.splice(r+s+.5,0,u)),c.forEach(p=>{const f=o.clips.indexOf(p);o.clips.splice(f,1),p.trackId=u.id,this.insertClip(u,p)})}this.clearTrackWithNoClip()},getCurClipGroup(){const t=new Map;return this.curClips.forEach(e=>{var s;const n=this.getTrackFromClip(e);if(!n)throw new Error("\u4E3A\u627E\u5230\u6240\u5728\u8F68\u9053");t.has(n)?(s=t.get(n))==null||s.push(e):t.set(n,[e])}),t},deleteCurClips(){const t=[];return this.curClips.forEach(e=>{t.push(e);const n=this.getTrackFromClip(e);if(!n)throw new Error("No track found");const s=n.clips.indexOf(e);n.clips.splice(s,1)}),this.curClips.clear(),t},getTrackFromClip(t){return this.tlData.tracks.find(e=>e.id===t.trackId)},clearTrackWithNoClip(){for(let t=0;t<this.tlData.tracks.length;t++)this.tlData.tracks[t].clips.length===0&&(this.tlData.tracks.splice(t,1),t--)},insertClip(t,e){let n=t.clips.length;for(let r=0;r<t.clips.length;r++){const{inPoint:u}=t.clips[r];if(u>=e.inPoint){n=r;break}}t.clips.splice(n,0,e);const{inPoint:s,outPoint:l}=e;let o=n-1;for(;o>=0;){const r=t.clips[o],{outPoint:u,trimOut:p,thumbnail:f}=r;if(u>l){r.outPoint=s;const h=new xe({type:r.type,trackId:t.id,inPoint:l,outPoint:u,trimOut:p,thumbnail:f,trimIn:p-(u-l)});t.clips.splice(n+1,0,h);break}else if(u>s){r.outPoint=s;break}else break}let c=n+1;for(;c<t.clips.length;){const r=t.clips[c],{inPoint:u,outPoint:p}=r;if(u<l)if(p<=l)t.clips.splice(c,1);else{r.inPoint=l;break}else break}}}});var F=(t,e)=>{const n=t.__vccOpts||t;for(const[s,l]of e)n[s]=l;return n};const Bt=["src"],Ut=O({setup(t){const e=N(null),{x:n,y:s}=Ee(e),l=j(),o=Q();let c={x:0,y:0},r=[],u=[];const p={code:200,"data|20":[{"duration|1000000-20000000":2e7,url:"@image(480x270, @color, #fff, 1)",name:"@name",thumbnail:"https://dummyimage.com/480x270/#color#/FFFFFF&text=",id:"@guid"}]},f=we.mock(p),h=N(f.data);let x=null,v=null;const X=($,L)=>{var I;x=L,document.body.addEventListener("pointermove",S),document.body.addEventListener("pointerup",ce,{once:!0}),e.value=document.querySelector(".track-container"),e.value&&(c=(I=e.value)==null?void 0:I.getBoundingClientRect())},S=$=>{if(!x)return;if(!o.isDragging){o.isDragging=!0,l.clearCurClip(),v=new xe(me(fe({},x),{type:M.VIDEO,inPoint:0,outPoint:x.duration})),l.addCurClip(v),r=l.getSings(),u=[];const A=v.type===M.VIDEO?H:q;let P=0;l.tlData.tracks.reduce((D,d)=>((v==null?void 0:v.type)&&d.type===E[v.type]&&(u.push(D),P=D),D+=d.type===E.VIDEO?H:q,D),0),u.push(P+A),console.log(u)}const{clientX:L,clientY:I,pointerId:b}=$;o.setTranslate(Y($),ee($)),document.body.setPointerCapture(b)},Y=$=>{const{clientX:L,clientY:I}=$;if(!!v){if(L>=c.x&&I>=c.y){const b=r.find(([D,d])=>Math.abs(d-(L-c.x+n.value-10))<=5);if(b){const[D,d]=b;return o.lineY={show:!0,pos:d},v.inPoint=D,v.outPoint=D+v.duration,d+c.x-n.value}const A=V(v.duration),P=r.find(([D,d])=>Math.abs(d-(L-c.x+n.value-10+A))<=5);if(P){const[D,d]=P;return o.lineY={show:!0,pos:d},v.inPoint=D-v.duration,v.outPoint=D,d+c.x-A-n.value}}return o.lineY={show:!1,pos:0},L-10}},ee=$=>{const{clientX:L,clientY:I}=$;if(!v)return;const b=v.type===M.VIDEO?H:q;for(let A=0;A<u.length;A++){const P=u[A];if(A===0){if(I<P+c.y+10-b/2)return o.lineX={show:!0,pos:P},I-10}else if(A===u.length-1&&I>P+c.y-b/4-10)return o.lineX={show:!0,pos:P},I-10;if(Math.abs(I-(P+c.y))<b/4)return o.lineX={show:!0,pos:P},P+c.y-b/2;if(I-c.y>P+b/4&&I-c.y<P+b/4*3)return o.lineX={show:!1,pos:0},P+c.y}return o.lineX={show:!1,pos:0},I-10},ce=$=>{document.body.releasePointerCapture($.pointerId),document.body.removeEventListener("pointermove",S),o.isDragging=!1,x=null,l.clearCurClip(),o.lineX={show:!1,pos:0},o.lineY={show:!1,pos:0}};return($,L)=>(m(),T(i(et),{style:{"max-height":"100%"}},{default:_(()=>[a(i(Qe),{cols:"2 s:3 m:4 l:5 xl:6 2xl:7",responsive:"screen","x-gap":12},{default:_(()=>[(m(!0),C(re,null,de(h.value,I=>(m(),T(i(tt),{key:I.id},{default:_(()=>[a(i(nt),{bordered:!1,onPointerdown:b=>X(b,I)},{cover:_(()=>[B("img",{src:I.url,onDragstart:L[0]||(L[0]=he(()=>{},["prevent"]))},null,40,Bt)]),default:_(()=>[a(i(st),{style:{"max-width":"100%"}},{default:_(()=>[U(ae(I.name),1)]),_:2},1024)]),_:2},1032,["onPointerdown"])]),_:2},1024))),128))]),_:1})]),_:1}))}});var Ht=F(Ut,[["__scopeId","data-v-783eabc6"]]);const Gt=t=>($e("data-v-cbf04404"),t=t(),Le(),t),Kt={class:"monitor"},qt=Gt(()=>B("canvas",{width:"960",height:"540"},null,-1)),Wt={class:"controls"},jt={class:"time"},Zt={class:"right"},Jt=O({setup(t){const e=j(),n=[{label:"0.5x",key:.5},{label:"1x",key:1},{label:"1.5x",key:1.5},{label:"2x",key:2},{label:"4x",key:4},{label:"8x",key:8}],s=G(()=>Se(e.seekVal)),l=G(()=>Se(e.duration)),o=()=>{e.isPlaying=!e.isPlaying},c=r=>{e.tlData.speed=r};return(r,u)=>(m(),C("div",Kt,[qt,B("div",Wt,[B("code",jt,ae(i(s))+"/"+ae(i(l)),1),a(i(pe),{class:"tools-bar-left"},{default:_(()=>[a(i(K),{size:18,class:"icon",title:"\u56DE\u5230\u5F00\u59CB"},{default:_(()=>[a(i(ot))]),_:1}),a(i(K),{size:18,class:"icon",title:i(e).isPlaying?"\u6682\u505C":"\u64AD\u653E",onClick:o},{default:_(()=>[i(e).isPlaying?(m(),T(i(rt),{key:1})):(m(),T(i(it),{key:0}))]),_:1},8,["title"]),a(i(K),{size:18,class:"icon",title:"\u56DE\u5230\u672B\u5C3E"},{default:_(()=>[a(i(at))]),_:1})]),_:1}),B("div",Zt,[a(i(lt),{trigger:"click",options:n,onSelect:c},{default:_(()=>[a(i(Me),{size:"tiny",style:{width:"36px"}},{default:_(()=>[U(ae(i(e).tlData.speed)+"x",1)]),_:1})]),_:1})])])]))}});var Qt=F(Jt,[["__scopeId","data-v-cbf04404"]]);const en={class:"tools"},tn={class:"tools-bar"},nn=U(" \u64A4\u9500 "),sn=U(" \u6062\u590D "),on=U(" \u5220\u9664 "),rn=U(" \u5207\u5272 "),an=U(" \u5355\u58F0\u9053\u5206\u79BB "),ln=U(" \u65F6\u95F4\u7EBF\u7F29\u5C0F "),cn=U(" \u65F6\u95F4\u7EBF\u653E\u5927 "),un=U(" \u5168\u5C40\u663E\u793A "),dn=O({setup(t){const e=Q(),n=j(),s=G({get(){return e.level},set(r){e.setLevel(r)}}),l=r=>{let u=e.level+r;u=Math.max(0,u),u=Math.min(le.length-1,u),e.setLevel(u)},o=G(()=>n.curClips.size>0),c=()=>{n.deleteCurClips()};return(r,u)=>{const p=Re,f=K,h=gt,x=pe,v=Ae;return m(),C("div",en,[a(p,{class:"divider"}),B("div",tn,[a(x,{class:"tools-bar-left"},{default:_(()=>[a(h,null,{trigger:_(()=>[a(f,{size:18,class:"icon"},{default:_(()=>[a(i(ct))]),_:1})]),default:_(()=>[nn]),_:1}),a(h,null,{trigger:_(()=>[a(f,{size:18,class:"icon"},{default:_(()=>[a(i(ut))]),_:1})]),default:_(()=>[sn]),_:1}),a(p,{vertical:""}),a(h,null,{trigger:_(()=>[a(f,{size:18,class:J({disabled:!i(o)}),onClick:c},{default:_(()=>[a(i(dt))]),_:1},8,["class"])]),default:_(()=>[on]),_:1}),a(h,null,{trigger:_(()=>[a(f,{size:18,class:"icon"},{default:_(()=>[a(i(pt))]),_:1})]),default:_(()=>[rn]),_:1}),a(h,null,{trigger:_(()=>[a(f,{size:18,class:"icon"},{default:_(()=>[a(i(_t))]),_:1})]),default:_(()=>[an]),_:1})]),_:1}),a(x,{class:"tools-bar-right"},{default:_(()=>[a(h,null,{trigger:_(()=>[a(f,{size:18,class:J(["icon",i(e).level===0?"disabled":""]),title:"",onClick:u[0]||(u[0]=X=>l(-1))},{default:_(()=>[a(i(ft))]),_:1},8,["class"])]),default:_(()=>[ln]),_:1}),a(v,{value:i(s),"onUpdate:value":u[1]||(u[1]=X=>mt(s)?s.value=X:null),class:"level",step:1,min:0,max:i(le).length-1},null,8,["value","max"]),a(h,null,{trigger:_(()=>[a(f,{size:18,class:J(["icon",i(e).level===i(le).length-1?"disabled":""]),onClick:u[2]||(u[2]=X=>l(1))},{default:_(()=>[a(i(ht))]),_:1},8,["class"])]),default:_(()=>[cn]),_:1}),a(p,{vertical:""}),a(h,null,{trigger:_(()=>[a(f,{size:18,class:"icon"},{default:_(()=>[a(i(vt))]),_:1})]),default:_(()=>[un]),_:1})]),_:1})]),a(p,{class:"divider",dashed:""})])}}});var pn=F(dn,[["__scopeId","data-v-80ee54c8"]]);const _n=O({setup(t){const e=Q(),n=j(),s=N(null),l=yt("--textColorBase",document.body);function o(){const p=document.querySelector(".track-container");if(!s.value||!p)return;const{STEP:f,TIME:h,GROUP:x}=le[e.level],{offsetWidth:v,offsetHeight:X}=s.value;s.value.width=v,s.value.height=X;const S=s.value.getContext("2d");if(!S)return;let Y=-p.scrollLeft%f;for(S.beginPath(),S.strokeStyle=l.value,S.fillStyle=l.value,S.font="13px monospace";Y<v;){const ee=(Y+p.scrollLeft)/f%x==0;if(S.moveTo(Y,X/(ee?1.5:1.1)),S.lineTo(Y,X),ee){const ce=Se(oe(Y+p.scrollLeft));S.fillText(ce,Y-39,24)}Y+=f}S.closePath(),S.stroke()}kt(()=>{const p=document.querySelector(".track-container");p==null||p.removeEventListener("scroll",o),window.removeEventListener("resize",o)}),Ne(()=>{const p=document.querySelector(".track-container");p==null||p.addEventListener("scroll",o),window.addEventListener("resize",o),o()}),Ct(e,()=>o());const c=p=>{const f=document.querySelector(".track-container");if(!f)return;const h=p.clientX-se+f.scrollLeft;n.seekVal=oe(h)},r=p=>{document.body.addEventListener("pointermove",u),document.body.addEventListener("pointerup",()=>{document.body.removeEventListener("pointermove",u)},{once:!0})},u=p=>{const f=document.querySelector(".track-container");if(!f)return;const h=p.clientX-se+f.scrollLeft;n.seekVal=Math.max(0,oe(h))};return(p,f)=>(m(),C("canvas",{ref_key:"canvas",ref:s,onClick:c,onPointerdown:r},null,544))}});var fn=F(_n,[["__scopeId","data-v-b451ea3c"]]);const mn=["id","onClick"],hn={key:0,class:"left tagger"},vn={key:1,class:"right tagger"},gn=O({props:{clip:null,index:null},setup(t){const e=t,n=j(),s=Q(),l=G(()=>{const{clip:d}=Ve(e),{inPoint:y,outPoint:k}=Ve(d.value),g=d.value.type===M.VIDEO?ze(d.value).join(","):be[d.value.type];return{left:V(y.value)+"px",width:V(k.value-y.value)+"px",background:g}});let[o,c]=[0,0],[r,u]=[e.clip.inPoint,e.clip.outPoint];const p=N(!1),f=N(!1),h=document.querySelector(".track-container");let x=[];const v=G(()=>n.curClips.has(e.clip)),X=G(()=>({clip:!0,"center-clip":![M.VIDEO,M.AUDIO].includes(e.clip.type),active:v.value})),S=d=>{(d==null?void 0:d.ctrlKey)?n.curClips.has(e.clip)?n.removeCurClip(e.clip):n.addCurClip(e.clip):(n.clearCurClip(),n.addCurClip(e.clip))},Y=d=>{o=d.clientX,c=d.clientY,document.body.addEventListener("pointermove",ee),document.body.addEventListener("pointerup",L,{once:!0})},ee=d=>{n.curClips.has(e.clip)||S(d);const y=d.clientX-o,k=d.clientY-c;if(Math.abs(y)>1||Math.abs(k)>1){s.isDragging||(s.setDragging(!0),s.sings=n.getSings());const g=n.getMinMax(),[Z,ie]=[d.clientX-o,d.clientY-c];s.setTranslate(ce(Z||0,g),$(ie||0)),document.body.setPointerCapture(d.pointerId)}},ce=(d,y)=>{const[k,g]=y;let Z=d;const ie=V(k)+d,R=s.sings.find(([ue,W])=>Math.abs(W-ie)<5);if(R)s.lineY={show:!0,pos:R[1]+((h==null?void 0:h.scrollLeft)||0)},Z=R[1]-V(k)-0,s.moveOffset=R[0]-k;else{const ue=V(g)+d,W=s.sings.find(([z,Ie])=>Math.abs(Ie-ue)<5);W?(s.lineY={show:!0,pos:W[1]+((h==null?void 0:h.scrollLeft)||0)},Z=W[1]-V(g)-0,s.moveOffset=W[0]-g):(s.lineY={show:!1,pos:0},s.moveOffset=oe(Z))}return Z},$=d=>{if(!n.isSameTrack())return 0;const y=n.tlData.tracks,k=[...n.curClips][0].trackId,g=y.find(z=>z.id===k),Z=g?y.indexOf(g):-1;let ie=!1;const R=(g==null?void 0:g.type)===E.VIDEO?H:q;let ue=-R/2,W=-R/2;if(y.forEach(z=>{z.id===k&&(ie=!0),z.type===(g==null?void 0:g.type)&&(ie?W+=R:ue-=R)}),d>=ue&&d<=W){const z=Math.round(d/(R/2))*(R/2);if(z%R==0)s.lineX={show:!1,pos:0},s.moveOffsetY=z;else{const Ie=y.reduce((De,{type:Ge},Ke)=>Ke<Z?De+(Ge===E.VIDEO?H:q):De,0);s.lineX={show:!0,pos:z+Ie+R/2},s.moveOffsetY=z}return z}return d},L=d=>{document.body.removeEventListener("pointermove",ee),document.body.releasePointerCapture(d.pointerId),s.sings=[],s.setDragging(!1);const{moveOffset:y,moveOffsetY:k}=s;n.moveCurClips(y,k),s.moveOffset=0,s.moveOffsetY=0,s.setTranslate()},I=d=>{o=d.clientX,r=e.clip.inPoint,document.body.addEventListener("pointermove",b),document.body.addEventListener("pointerup",y=>D(y,b),{once:!0}),p.value=!0,x=n.getSings(),document.body.style.cursor="col-resize"},b=d=>{document.body.setPointerCapture(d.pointerId);const y=x.find(([k,g])=>Math.abs(g-(d.clientX-se))<5&&k<=e.clip.outPoint);if(y){const[k,g]=y;e.clip.inPoint=ke(k,[0,e.clip.outPoint]),s.lineY={show:!0,pos:g+((h==null?void 0:h.scrollLeft)||0)}}else{const k=d.clientX-o,g=oe(k);e.clip.inPoint=ke(g+r,[0,e.clip.outPoint]),s.lineY={show:!1,pos:0}}},A=d=>{o=d.clientX,u=e.clip.outPoint,document.body.addEventListener("pointermove",P),document.body.addEventListener("pointerup",y=>D(y,P),{once:!0}),f.value=!0,x=n.getSings()},P=d=>{document.body.setPointerCapture(d.pointerId);const y=x.find(([k,g])=>Math.abs(g-(d.clientX-se))<5&&k>=e.clip.inPoint);if(y){const[k,g]=y;e.clip.outPoint=ke(k,[e.clip.inPoint,1/0]),s.lineY={show:!0,pos:g+((h==null?void 0:h.scrollLeft)||0)}}else{const k=d.clientX-o,g=oe(k);e.clip.outPoint=ke(g+u,[e.clip.inPoint,1/0]),s.lineY={show:!1,pos:0}}},D=(d,y)=>{document.body.removeEventListener("pointermove",y),document.body.releasePointerCapture(d.pointerId),n.moveCurClips(0,0),f.value=!1,p.value=!1,s.lineY={show:!1,pos:0},document.body.style.cursor="default"};return(d,y)=>xt((m(),C("div",{class:J(i(X)),id:e.clip.id,style:ne(i(l)),onClick:he(S,["stop"]),onPointerdown:Y},[i(v)?(m(),C("div",hn,[a(i(K),{class:J(["left","handle",p.value?"dragging":""]),onPointerdown:he(I,["stop"])},{default:_(()=>[a(i(Fe))]),_:1},8,["class","onPointerdown"])])):te("",!0),B("p",null,ae(e.clip.name),1),i(v)?(m(),C("div",vn,[a(i(K),{class:J(["right","handle",f.value?"dragging":""]),onPointerdown:he(A,["stop"])},{default:_(()=>[a(i(Fe))]),_:1},8,["class","onPointerdown"])])):te("",!0)],46,mn)),[[It,!(i(v)&&i(s).isDragging)]])}});var yn=F(gn,[["__scopeId","data-v-46f5aa8d"]]);const kn=O({props:{track:null},setup(t){const e=t;ve(s=>({"652e21be":n}));const n=(e.track.type===E.VIDEO?H:q)+"px";return(s,l)=>(m(),C("div",{class:J(["track",t.track.show?"":"hidden"])},[(m(!0),C(re,null,de(e.track.clips,(o,c)=>(m(),T(yn,{key:o.id,clip:o,index:c},null,8,["clip","index"]))),128))],2))}});var Cn=F(kn,[["__scopeId","data-v-70e49654"]]);const xn=O({setup(t){ve(p=>({"9a742154":e.value}));const e=N(se+"px"),n=j(),s=Q(),l=N(null),{x:o,y:c}=Ee(l);Pt(()=>{});const r=G(()=>({transform:`translateX(${s.lineY.pos}px)`,left:-o+"px",height:n.tlData.tracks.reduce((p,f)=>(f.type===E.VIDEO?p+=H:p+=q,p),0)+"px"})),u=p=>{if(!p.target)return;const h=p.target.scrollTop,x=document.querySelector(".track-controls");x&&(x.scrollTop=h)};return(p,f)=>(m(),C("div",{class:"track-container",ref_key:"el",ref:l,onScroll:u,onClick:f[0]||(f[0]=(...h)=>i(n).clearCurClip&&i(n).clearCurClip(...h))},[(m(!0),C(re,null,de(i(n).tlData.tracks,h=>(m(),T(Cn,{key:h.id,track:h},null,8,["track"]))),128)),i(s).lineY.show?(m(),C("div",{key:0,class:"line-y",style:ne(i(r))},null,4)):te("",!0),i(s).lineX.show?(m(),C("div",{key:1,class:"line-x",style:ne({transform:`translateY(${i(s).lineX.pos+i(Ft)}px)`})},null,4)):te("",!0)],544))}});const In={class:"track-controls"},Pn={key:0,class:"volume"},Tn=O({setup(t){const e=j(),n=o=>({height:(o.type===E.VIDEO?H:q)+3+"px"}),s=o=>{o.show=!o.show},l=(o,c)=>{o.volume=c};return(o,c)=>(m(),C("div",In,[(m(!0),C(re,null,de(i(e).tlData.tracks,r=>(m(),T(i(pe),{class:"control",style:ne(n(r)),key:r.id},{default:_(()=>[a(i(K),{size:18,class:"icon default"},{default:_(()=>[r.type===i(E).VIDEO?(m(),T(i(Tt),{key:0})):r.type===i(E).STICKER?(m(),T(i(wt),{key:1})):r.type===i(E).CAPTION?(m(),T(i(Et),{key:2})):te("",!0)]),_:2},1024),a(i(K),{size:18,class:"icon",onClick:u=>s(r)},{default:_(()=>[r.show?(m(),T(i(St),{key:0})):(m(),T(i(bt),{key:1}))]),_:2},1032,["onClick"]),[i(E).VIDEO,i(E).AUDIO].includes(r.type)?(m(),C("div",Pn,[a(i(K),{size:18,class:"icon",onClick:u=>l(r,r.volume===0?1:0)},{default:_(()=>[r.volume>0?(m(),T(i(Dt),{key:0})):(m(),T(i(Ot),{key:1}))]),_:2},1032,["onClick"]),a(i(Ae),{value:r.volume,"onUpdate:value":u=>r.volume=u,step:.1,min:0,max:2},null,8,["value","onUpdate:value","step"])])):te("",!0)]),_:2},1032,["style"]))),128))]))}});const wn=["id"],En=O({props:{clip:null,style:null},setup(t){const e=t,n=document.getElementById(e.clip.id);let[s,l,o,c]=[V(e.clip.duration),e.clip.type===M.VIDEO?H:q,0,0];if(n){const p=n.getBoundingClientRect()||{};s=p.width,l=p.height,o=p.left,c=p.top}const r=(n==null?void 0:n.style.background)||ze(e.clip).join(","),u=N({width:s+"px",height:l+"px",left:o+"px",top:c+"px",background:r});return(p,f)=>(m(),C("div",{class:J({"clip-mini":!0,"center-clip":![i(M).VIDEO,i(M).AUDIO].includes(e.clip.type)}),id:"mini-"+e.clip.id,style:ne(u.value)},[B("p",null,ae(e.clip.name),1)],14,wn))}});var Sn=F(En,[["__scopeId","data-v-675e94a8"]]);const bn=O({setup(t){const e=j(),n=Q(),s=N(null),l=G(()=>{const[o,c]=n.translate;return{transform:`translate(${o}px, ${c}px)`}});return(o,c)=>i(n).isDragging?(m(),C("div",{key:0,class:"dragging-clips",style:ne(i(l)),ref_key:"draggingContainer",ref:s},[(m(!0),C(re,null,de(i(e).curClips,r=>(m(),T(Sn,{key:r.id,clip:r},null,8,["clip"]))),128))],4)):te("",!0)}});var Dn=F(bn,[["__scopeId","data-v-afed1be6"]]);const On=O({setup(t){ve(r=>({"503d17fd":s.value}));const e=j(),n=N(null),s=N(se+"px"),{x:l,y:o}=Ee(n),c=G(()=>{const u=V(e.seekVal)-l.value;return{transform:`translate(${u<0?-200:u}px)`}});return Ne(()=>{n.value=document.querySelector(".track-container")}),(r,u)=>(m(),C("div",{class:"seek-line",style:ne(i(c))},null,4))}});var Mn=F(On,[["__scopeId","data-v-67cde125"]]);const $n={class:"timeline"},Ln=O({setup(t){ve(n=>({"71bbf79c":e.value}));const e=N(se+"px");return(n,s)=>(m(),C("div",$n,[a(pn),a(fn),a(Tn),a(xn),a(Dn),a(Mn)]))}});var Rn=F(Ln,[["__scopeId","data-v-6e00895a"]]);const Ue=Te("themeStore",{state:()=>{const t=localStorage.getItem("isDark");let e=null;return t===null?window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches&&(e=ge,document.body.classList.add("dark")):t==="true"&&(e=ge,document.body.classList.add("dark")),{theme:e}},actions:{changeTheme(t){const e=document.body;t===void 0?this.theme=this.theme?null:ge:this.theme=t?ge:null,this.theme?(e.classList.add("dark"),localStorage.setItem("isDark","true")):(e.classList.remove("dark"),localStorage.setItem("isDark","false"))}}});const An=t=>($e("data-v-422a3b43"),t=t(),Le(),t),Nn={class:"title-bar"},Vn=An(()=>B("div",{class:"logo"},"Logo",-1)),Fn=U("\u5BFC\u51FA"),Xn=O({setup(t){const e=Ue();return window.matchMedia("(prefers-color-scheme: dark)").addListener(n=>{e.changeTheme(n.matches)}),(n,s)=>(m(),C(re,null,[B("div",Nn,[Vn,a(i(pe),{class:"tools-center"}),a(i(pe),null,{default:_(()=>[a(i(K),{onClick:s[0]||(s[0]=l=>i(e).changeTheme()),size:20},{default:_(()=>[i(e).theme?(m(),T(i(Mt),{key:0})):(m(),T(i($t),{key:1}))]),_:1}),a(i(Me),{size:"small",type:"primary"},{default:_(()=>[Fn]),_:1})]),_:1})]),a(i(Re),{class:"divider"})],64))}});var Yn=F(Xn,[["__scopeId","data-v-422a3b43"]]);const zn={class:"editor"},Bn={class:"content"},Un=O({setup(t){return(e,n)=>(m(),C("div",zn,[a(Yn),B("div",Bn,[a(Ht),a(Qt)]),a(Rn)]))}});var Hn=F(Un,[["__scopeId","data-v-5db381ca"]]);const Gn=O({setup(t){const e=Ue();return(n,s)=>(m(),T(i(Lt),{theme:i(e).theme},{default:_(()=>[a(Hn),a(i(Rt))]),_:1},8,["theme"]))}});const He=At(Gn);He.use(Nt());He.mount("#app");
